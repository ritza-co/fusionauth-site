---
title: Get Google account details and contacts through FusionAuth
description: Learn how to get a user's Google contacts to send referral emails.
navcategory: developer
section: lifecycle
subcategory: authenticate users
codeRoot: TODOhttps://raw.githubusercontent.com/FusionAuth/fusionauth-example-node-sso/main
---
import Aside from 'src/components/Aside.astro';
import IconButton from 'src/components/IconButton.astro';
import Breadcrumb from 'src/components/Breadcrumb.astro';
import InlineField from 'src/components/InlineField.astro';
import InlineUIElement from 'src/components/InlineUIElement.astro';

## Introduction

You don't want to use the Google Identity Provider because it doesn't support the prompt URL parameter.
Use the OIDC Identity Provider with the prompt parameter set to select_account to let the users pick different accounts

## Run code

```sh
cd ~/code/rjeritza/16_faGoogleConnect
docker compose up
# new terminal
cd completeApplication
npm install  # todo use docker here too
npm run start

```

## Set up project in Google console

- First register the domain you want to use with Google here - https://search.google.com/search-console/about
  - For testing purposes if you want to make a free domain, use https://www.cloudns.net, and point it to a free Google Sites website
- https://console.cloud.google.com
- new project - fago
- In the API Library, enable Google People API
- APIs & Services - Credentials
- Create Credentials - OAuth Client ID
- Configure Consent Screen
- Choose user type `External` unless you want Internal users only (https://support.google.com/cloud/answer/10311615#user-type&zippy=%2Cexternal%2Cinternal)
- App name `fago`
- Upload any 120 px by 120 px image
- Enter the urls of your website
- Save and continue
- Click Add or remove scopes, enable `.../auth/contacts.readonly` `See and download your contacts`
- Save and continue
- Add your own gmail address as a test user
- Save and continue
- If it says ` Ineligible accounts not added. The following email addresses are either not associated with a Google Account or the account is not eligible for designation as a test user` ignore it

## Set up identity provider in FusionAuth

https://fusionauth.io/docs/lifecycle/authenticate-users/identity-providers/
says go [Settings -> Identity Providers ](http://localhost:9011/admin/identity-provider)
`Add OpenID Connect`, not `Add Google`.  You don't want to use the Google Identity Provider because it doesn't support the `prompt` URL parameter.
- id 26481189-e3f7-433f-804b-9643a025806a
- name connectgoo





## Todo


- https://drafts.cc.ritza.co/s/CIi3qE_d0#
- read:
  - https://fusionauth.io/community/forum/topic/2569/how-do-i-call-a-google-api-or-retrieve-the-google-credentials
  - https://fusionauth.io/community/forum/topic/2659/access-google-calendars-of-multiple-google-accounts-with-user-permission

- goal: get user's contacts' email addresses from google
- process:
  - user logs in to changebank/fusionauth with username/password (this with email or google button though?)
  - button calls FA identity provider login OIDC API to login to google (i assume https://fusionauth.io/docs/apis/identity-providers/openid-connect)
    - login uses Google scope https://www.googleapis.com/auth/contacts.readonly
  - after login, application gets refresh token from FA.
  - app gets contact list from google api with refresh token

- fa account must be linked to one or more google accounts